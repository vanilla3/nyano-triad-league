# Nyano Triad League — Game UI / Product Spec v1（Draft, ja）

このドキュメントは **「今は機能（参照ツール）」→「運営品質のゲーム」**へ移行するための仕様整理です。  
プロトコルや自律性（運営が消えても盛り上がる）を前提にしつつ、**“遊びやすいUX”** を後から積む方針を明確化します。

---

## 0. 現状（いまのUIは“機能”）

現在の UI は、以下の **参照レイヤ** が中心です。

- Playground：公式ベクタから再現（議論の起点）
- Replay：transcript から再現（共有の中心）
- Nyano：tokenId からカード性能に変換（実物の観察）
- Rulesets：ルールIDの固定（合意の核）

これらは **「運営不在でも検証・共有が止まらない」**ための最小装置です。  
ただし、現時点は **ゲーム体験としての導線（遊び始める/遊び続ける）**が弱い。

---

## 1. 目標（次の段階：運営品質のゲーム）

### 1.1 UX目標
- **迷子にならない**：何をすれば遊べるかが明確（入口→手順→結果）
- **気持ちよく共有できる**：URL/コピー/再現が軽い
- **ログが“読める”**：なぜ勝ったかが説明される（実況性）
- **失敗が“分かる”**：RPC/owner mismatch/欠損などの原因が示される

### 1.2 プロトコル目標（崩さない）
- transcript が唯一の真実（決定論再現できる）
- rulesetId/engineId が合意の核（分裂しにくい）
- オンチェーンは“最終確定”に限定（重い処理はしない）

---

## 2. 情報設計（IA）

### 2.1 画面カテゴリ
- **Play**
  - Arena（ゲームの入口）
  - Decks（デッキの作成/管理/共有）
  - Match（対戦UI：ローカル→署名→オンチェーン提出へ段階導入）
- **Watch**
  - Replay（共有リンクから再現）
- **Tools**
  - Playground / Nyano / Rulesets

### 2.2 “運営がいなくても回る”ための最低要素
- 共有リンク（短い/壊れにくい/互換維持）
- 公式ルールのスナップショット（rulesets/official_onchain_rulesets.json）
- 参照UI（Replay）と検証UI（Playground）
- ベクタ（TS↔Solidity）で挙動を固定

---

## 3. ゲームループ（MVP → 拡張）

### 3.1 MVP（運営品質の入口）
1) デッキを作る（Nyano tokenId 5枚）  
2) 対戦する（ローカル対戦 or 対戦手順のガイド）  
3) 結果とログを見る（理由が分かる）  
4) transcript を共有する（Replay で誰でも再現）

### 3.2 拡張（競技性）
- 署名（EIP-712）とオンチェーン提出（1 tx）
- ルールの季節運用（Season/Ruleset rotation）
- リーグ（ランキング、報酬配布、トーナメント）
- コミュニティ運営（第三者が大会を立てられる）

---

## 4. UI品質の要件（運営視点）

- **可観測性**：RPC/contract/バージョン表示、エラー文脈（tokenId単位）
- **説明可能性**：flip理由、コンボ/マーク/補正の見える化
- **互換性**：share link は破壊しない（t/z互換、将来は compact schema）
- **アクセシビリティ**：キーボード操作、見やすいコントラスト、レスポンシブ

---

## 5. 非目標（この段階でやらない）
- リアルタイム同期ゲーム（サーバ必須）を最初から作らない  
  → 先に transcript 文化（非同期共有）を成立させる  
- 単一運営が全てを握る設計にしない  
  → “勝手に盛り上がる”余地（外部ツール/大会）を残す


---

## 6. Nyano（AI）対戦とイベント運用（構想）

「運営がいなくなっても勝手に盛り上がる」ためには、PvP だけでなく **“いつでも挑める固定の熱源”** が必要です。  
そこで、最終的に **AIキャラ（Nyano）** と対戦できる仕組みを用意します。

### 6.1 ねらい
- イベント運用が容易（期間中、いつでも挑戦できる）
- 参照文化を育てる（勝因/敗因を replay で共有して盛り上がる）
- 運営依存を減らす（サーバや裁定に頼らない）

### 6.2 最初の設計方針（重要）
- **AIはクライアントで動作**（サーバ不要）
- **結果は transcript が全て**（AIの意思決定を再現する必要はなく、結果が再現できれば良い）
- 将来、オンチェーン提出をする場合は「AIの署名/承認」をどう扱うかが課題  
  → ERC-6551（TBA）や ERC-1271（contract signature）などの設計余地がある（別紙）。


---

## 7. Events（運用の中心）

イベントは “運営がいなくなっても盛り上がる” ための **固定の熱源** です。  
UIとしては以下を満たすことを最優先にします。

- 条件が固定される（ruleset / Nyano AI / Nyano deck）
- 共有と再現が軽い（Replayで誰でも検証できる）
- 結果が比較できる（同じ条件で戦えるので議論が育つ）

実装上は `apps/web/src/lib/events.ts` にイベント定義（v1）を置き、`/events` で一覧表示します。


### Events: My Attempts（ローカル保存）
- Replay 画面でイベント結果を `Save` すると、`/events` の各イベントカードに My Attempts が表示されます。
- v1 は localStorage ベースで “まず回る” を優先し、将来オンチェーン提出・ランキングへ拡張します。
